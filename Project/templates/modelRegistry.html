{% load static %}

<!DOCTYPE html>
<html :class="{ 'theme-dark': dark }" x-data="data()" lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Challengers Model Registry [WIP]</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <!-- <link rel="stylesheet" href="./assets/css/tailwind.output.css" /> -->
  <link rel="stylesheet" href={% static '/css/tailwind.output.css' %} />
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
  <!-- <script src="./assets/js/init-alpine.js"></script> -->
  <script src={% static '/js/init-alpine.js' %}></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js" defer></script>
  <!-- <script src="./assets/js/charts-lines.js" defer></script> -->
  <script src={% static '/js/charts-lines.js' %} defer></script>
  <!-- <script src="./assets/js/charts-pie.js" defer></script> -->
  <script src={% static '/js/charts-pie.js' %} defer></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.4/flowbite.min.css" rel="stylesheet" />

  <style>
    /* Style the tab */
    .tab {
      overflow: hidden;
      border: 1px solid #ccc;
      background-color: #f1f1f1;
    }

    /* Style the buttons inside the tab */
    .tab button {
      background-color: inherit;
      float: left;
      border: none;
      outline: none;
      cursor: pointer;
      padding: 14px 16px;
      transition: 0.3s;
      font-size: 17px;
    }

    /* Change background color of buttons on hover */
    .tab button:hover {
      background-color: #ddd;
    }

    /* Create an active/current tablink class */
    .tab button.active {
      background-color: #ccc;
    }

    #consolelog-output {
      background-color: white;
      height: 100%;
      margin-bottom: 10px;
      border: 1px solid black;
      color: black;
      width: 100%;
      overflow-y: scroll;
      /* add scrollbar when content exceeds height */
      padding: 10px;
      font-size: 14px;
    }


    /* Dropdown Button */
    .dropbtn_reason {
      background-color: #04AA6D;
      color: white;
      padding: 5px;
      font-size: 14px;
      border: none;
      height: 50%;
      margin-left: 10px;
    }

    /* The container <div> - needed to position the dropdown content */
    .dropdown-mr {
      position: relative;
      display: inline-block;
    }

    /* Dropdown Content (Hidden by Default) */
    .dropdown-content-reason {
      display: none;
      position: absolute;
      background-color: #f1f1f1;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
      z-index: 1;
    }

    /* Links inside the dropdown */
    .dropdown-content-reason a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
    }

    /* Change color of dropdown links on hover */
    .dropdown-content-reason a:hover {
      background-color: #ddd;
    }

    /* Show the dropdown menu on hover */
    .dropdown-mr:hover .dropdown-content-reason {
      display: block;
    }

    /* Change the background color of the dropdown button when the dropdown content is shown */
    .dropdown-mr:hover .dropbtn_reason {
      background-color: #3e8e41;
    }

    .dropbtn {
      background-color: #3498DB;
      color: white;
      padding: 16px;
      font-size: 16px;
      border: none;
      cursor: pointer;
    }

    .dropbtn:hover,
    .dropbtn:focus {
      background-color: #2980B9;
    }

    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #f1f1f1;
      min-width: 160px;
      overflow: auto;
      box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
      z-index: 1;
    }

    .dropdown-content a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
    }

    .dropdown a:hover {
      background-color: #ddd;
    }

    .show {
      display: block;
    }
  </style>

</head>

<body>
  {% if messages %}
  {% for message in messages %}
  <div id="messageAlert">{{ message }}</div>
  {% endfor %}
  {% endif %}

  <div class="flex h-screen bg-gray-50 dark:bg-gray-900" :class="{ 'overflow-hidden': isSideMenuOpen }">
    <!-- Desktop sidebar -->
    <!-- <aside
        class="z-20 hidden w-64 overflow-y-auto bg-white dark:bg-gray-800 md:block flex-shrink-0"
      >
        <div class="py-4 text-gray-500 dark:text-gray-400">
          <a
            class="ml-6 text-lg font-bold text-gray-800 dark:text-gray-200"
            href="#"
          >
            MLOps Suite
          </a>
          <ul class="mt-6">
            <li class="relative px-6 py-3">
              <span
                class="absolute inset-y-0 left-0 w-1 bg-purple-600 rounded-tr-lg rounded-br-lg"
                aria-hidden="true"
              ></span>
              <a
                class="inline-flex items-center w-full text-sm font-semibold text-gray-800 transition-colors duration-150 hover:text-gray-800 dark:hover:text-gray-200 dark:text-gray-100"
                href="/app/deployment/"
              >
                <svg
                  class="w-5 h-5"
                  aria-hidden="true"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                  ></path>
                </svg>
                <span class="ml-4">Deployments</span>
              </a>
            </li>
          </ul>
        </div>
      </aside> -->
    <div class="flex flex-col flex-1 w-full">
      <header class="z-10 py-4 bg-white shadow-md dark:bg-gray-800">
        <div class="container flex items-center h-full mx-auto text-purple-600 dark:text-purple-300">
          <a class="ml-6 text-lg font-bold text-gray-800 dark:text-gray-200" href="/app/deployment/">
            MLOps Suite
          </a>
          <!-- Search input -->
          <div class="flex justify-center flex-1 mx-30 lg:mr-32">
            <!-- <div
                class="relative w-full max-w-xl mr-6 focus-within:text-purple-500"
              >
                <div class="absolute inset-y-0 flex items-center pl-2">
                  <svg
                    class="w-4 h-4"
                    aria-hidden="true"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                      clip-rule="evenodd"
                    ></path>
                  </svg>
                </div>
                <input
                  class="w-full pl-8 pr-2 text-sm text-gray-700 placeholder-gray-600 bg-gray-100 border-0 rounded-md dark:placeholder-gray-500 dark:focus:shadow-outline-gray dark:focus:placeholder-gray-600 dark:bg-gray-700 dark:text-gray-200 focus:placeholder-gray-500 focus:bg-white focus:border-purple-300 focus:outline-none focus:shadow-outline-purple form-input"
                  type="text"
                  placeholder="Search for projects"
                  aria-label="Search"
                />
              </div> -->
          </div>
          <ul class="flex items-center flex-shrink-0 space-x-6">
            <!-- Theme toggler -->
            <li class="flex">
              <button class="rounded-md focus:outline-none focus:shadow-outline-purple" @click="toggleTheme"
                aria-label="Toggle color mode">
                <template x-if="!dark">
                  <svg class="w-5 h-5" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                  </svg>
                </template>
                <template x-if="dark">
                  <svg class="w-5 h-5" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                      d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                      clip-rule="evenodd"></path>
                  </svg>
                </template>
              </button>
            </li>
            <!-- Notifications menu -->
            <li class="relative">
              <button class="relative align-middle rounded-md focus:outline-none focus:shadow-outline-purple"
                @click="toggleNotificationsMenu" @keydown.escape="closeNotificationsMenu" aria-label="Notifications"
                aria-haspopup="true">
                <svg class="w-5 h-5" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20">
                  <path
                    d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z">
                  </path>
                </svg>
                <!-- Notification badge -->
                <span aria-hidden="true"
                  class="absolute top-0 right-0 inline-block w-3 h-3 transform translate-x-1 -translate-y-1 bg-red-600 border-2 border-white rounded-full dark:border-gray-800"></span>
              </button>
              <template x-if="isNotificationsMenuOpen">
                <ul x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100"
                  x-transition:leave-end="opacity-0" @click.away="closeNotificationsMenu"
                  @keydown.escape="closeNotificationsMenu"
                  class="absolute right-0 w-56 p-2 mt-2 space-y-2 text-gray-600 bg-white border border-gray-100 rounded-md shadow-md dark:text-gray-300 dark:border-gray-700 dark:bg-gray-700">
                  <li class="flex">
                    <a class="inline-flex items-center justify-between w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                      href="#">
                      <span>Messages</span>
                      <span
                        class="inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-600 bg-red-100 rounded-full dark:text-red-100 dark:bg-red-600">
                        13
                      </span>
                    </a>
                  </li>
                  <!-- <li class="flex">
                      <a
                        class="inline-flex items-center justify-between w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                        href="#"
                      >
                        <span>Sales</span>
                        <span
                          class="inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-600 bg-red-100 rounded-full dark:text-red-100 dark:bg-red-600"
                        >
                          2
                        </span>
                      </a>
                    </li> -->
                  <li class="flex">
                    <a class="inline-flex items-center justify-between w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                      href="#">
                      <span>Alerts</span>
                    </a>
                  </li>
                </ul>
              </template>
            </li>
            <!-- Profile menu -->
            <li class="relative">
              <button class="align-middle rounded-md focus:shadow-outline-purple focus:outline-none"
                @click="toggleProfileMenu" @keydown.escape="closeProfileMenu" aria-label="Account" aria-haspopup="true">
                <!-- <img
                    class="object-cover w-8 h-8 rounded-full"
                    src="https://images.unsplash.com/photo-1502378735452-bc7d86632805?ixlib=rb-0.3.5&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=200&fit=max&s=aa3a807e1bbdfd4364d1f449eaa96d82"
                    alt=""
                    aria-hidden="true"
                  /> -->
                <svg class="w-5 h-5" fill="currentColor" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z">
                  </path>
                </svg>
              </button>
              <template x-if="isProfileMenuOpen">
                <ul x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100"
                  x-transition:leave-end="opacity-0" @click.away="closeProfileMenu" @keydown.escape="closeProfileMenu"
                  class="absolute right-0 w-56 p-2 mt-2 space-y-2 text-gray-600 bg-white border border-gray-100 rounded-md shadow-md dark:border-gray-700 dark:text-gray-300 dark:bg-gray-700"
                  aria-label="submenu">
                  <li class="flex">
                    <a class="inline-flex items-center w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                      href="#">
                      <span>Profile</span>
                    </a>
                  </li>
                  <li class="flex">
                    <a class="inline-flex items-center w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                      href="#">
                      <span>Settings</span>
                    </a>
                  </li>
                  <li class="flex">
                    <a class="inline-flex items-center w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                      href="#">
                      <span>Log out</span>
                    </a>
                  </li>
                </ul>
              </template>
            </li>
          </ul>
        </div>
      </header>
      <main class="h-full overflow-y-auto">
        <div class="container px-6 my-6 mx-auto grid">
          <!-- New Table -->
          <div class="w-full overflow-hidden shadow-xs">
            <div class="w-full overflow-x-auto">
              <table class="w-full whitespace-no-wrap">
                <tbody class="bg-white divide-y dark:divide-gray-700 dark:bg-gray-800">
                  <tr class="text-gray-700 dark:text-gray-400">
                    <td class="px-4 py-3">
                      <div class="flex items-center text-sm">
                        <div>
                          <p class="font-semibold">HDB Pricing Prediction</p>
                          <p class="text-xs text-gray-600 dark:text-gray-400">
                            <!--Can include pending status here-->
                          </p>
                        </div>
                      </div>
                    </td>
                    <td class="px-4 py-3 text-sm">
                      High
                    </td>
                    <td class="px-4 py-3 text-xs">
                      <svg fill="none" stroke="green" stroke-width="1.5" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true" width="50" height="50">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path>
                      </svg>
                    </td>
                    <td class="px-4 py-3 text-sm">
                      <svg fill="black" stroke="yellow" stroke-width="1.5" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true" width="50" height="50">
                        <path stroke-linecap="round" stroke-linejoin="round"
                          d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z">
                        </path>
                      </svg>
                    </td>
                    <td class="px-4 py-3 text-sm">
                      <svg fill="none" stroke="red" stroke-width="1.5" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true" width="50" height="50">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
                      </svg>
                    </td>
                    <td class="px-4 py-3 text-sm">
                      1 day ago
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!--Navigation tabs to other pages-->
          <div class="main-content py-7 flex-1 bg-white shadow-md dark:bg-gray-800 mt-12 md:mt-2 pb-24 md:pb-5">
            <ul class="flex">
              <li class="text-center flex-1">
                <a class="text-center block rounded text-gray-700 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 py-2 px-4"
                  href="/app/overview">Overview</a>
              </li>
              <li class="text-center flex-1">
                <a class="text-center block text-gray-700 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 py-2 px-4"
                  href="/app/overview/service_health">Service Health</a>
              </li>
              <li class="text-center flex-1">
                <a class="text-center block rounded text-gray-700 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 py-2 px-4"
                  href="/app/drift">Data Drift</a>
              </li>
              <li class="text-center flex-1">
                <a class="text-center block rounded text-gray-700 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 py-2 px-4"
                  href="/app/overview/accuracy">Accuracy</a>
              </li>
              <li class="text-center flex-1">
                <a class="text-center block rounded text-gray-700 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 py-2 px-4"
                  href="/app/humility">Humility</a>
              </li>
              <li class="text-center flex-1">
                <a class="text-center block text-purple-600 dark:text-purple-400 hover:text-gray-800 dark:hover:text-gray-200 py-2 px-4"
                  href="/app/challengers">Challengers</a>
              </li>
            </ul>
          </div>
          <!--Content for your page-->
          <div class="container mx-auto grid">
            <div class="flex flex-row justify-between p-4 my-8 text-l font-semibold text-purple-100 bg-purple-600">
              <div>
                <p> Model Registry </p>
              </div>
            </div>
            <div class="grid gap-6 xl:grid-cols-2 mx-6">
              <div class="tab">
                <button class="tablinks bg-purple-600 text-s font-semibold" onclick="openTab(event, 'addNewModel')"
                  id="defaultOpen">Add new model</button>
                <button class="tablinks bg-purple-600 text-s font-semibold"
                  onclick="openTab(event, 'createNewModel')">Create new model</button>
              </div>

              <div id="addNewModel" class="tabcontent w-full overflow-hidden shadow-xs mx-6">
                <div class="flex mx-6">
                  <div class="mr-6 flex-1">
                    <!-- Your form code goes here -->
                    <form class="bg-gray-100">
                      <div class="mb-4 mx-6">
                        <label class="block text-gray-700 font-bold mb-2" for="modelname_file">
                          Name
                        </label>
                        <input
                          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                          id="modelname_file" type="text" placeholder="">
                        </input>
                      </div>

                      <div class="mb-4 mx-6">
                        <label class="block text-gray-700 font-bold mb-2" for="projectname_select_file">
                          Project Name
                        </label>
                        <select id="projectname_select_file"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/3 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                          <option value='default' selected>Select Project</option>
                          {% for pn in project_name %}
                          <option value="{{ pn.Project_Name }}">{{ pn.Project_Name }}</option>
                          {% endfor %}
                        </select>

                      </div>

                      <div class="mb-4">
                        <label class="block text-gray-700 font-bold mb-2" for="dropdown">
                          Language
                        </label>
                        <select
                          class="block appearance-none w-full bg-white border border-gray-400 hover:border-gray-500 px-4 py-2 pr-8 rounded shadow leading-tight focus:outline-none focus:shadow-outline"
                          id="modellanguage_file" name="dropdown">
                          <option value="python">Python</option>
                          <option value="javascript">Javascript</option>
                          <option value="c">C</option>
                          <option value="cpp">C++</option>
                        </select>
                      </div>

                      <div class="mb-4">
                        <label class="block text-gray-700 font-bold mb-2" for="version">
                          Version
                        </label>
                        <input
                          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                          id="modelversion_file" type="text" placeholder="">
                        </input>
                      </div>

                      <div class="mb-4">
                        <label class="block text-gray-700 font-bold mb-2" for="username">
                          Description
                        </label>
                        <input
                          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                          id="modeldescription_file" type="text" placeholder="">
                        </input>
                      </div>

                    </form>

                    <div class="flex gap-4">
                      <div>
                        <button id="open-form"
                          class="mb-4 bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700 mr-1"
                          type="button">+Add new files</button>
                        <button
                          class="mb-4 bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700 ml-2"
                          id="gitlab-button">Access GitLab</button>
                        <form id="upload-form" class="hidden" enctype="multipart/form-data">
                          <div class="flex items-center justify-between mr-1">
                            <input type="file" name="file" id="file-input" />
                            <!-- <button type="submit" -->
                            <button type="button"
                              class="bg-blue-500 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mr-2"
                              id="upload-file-btn">
                              Upload
                            </button>
                            <button
                              class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline ml-2"
                              type="close" id="close">Close</button>
                        </form>
                      </div>
                      <script>
                        var gitlabButton = document.getElementById("gitlab-button");
                        gitlabButton.addEventListener("click", openGitLab);
                        const form = document.getElementById("upload-form");
                        const button = document.getElementById("open-form");
                        const fileInput = document.getElementById("file-input");
                        const gitUrlInput = document.getElementById("git-url-input");
                        const uploadFileBtn = document.getElementById("upload-file-btn");

                        button.addEventListener("click", () => {
                          form.classList.remove("hidden");
                        });

                        uploadFileBtn.addEventListener("click", () => {
                          alert('Successfully uploaded file.')

                          // reenable buttons after file is uploaded.
                          var testbtn_addnewmodel = document.getElementById('testbtn_addnewmodel');
                          var add_mr_btn_file = document.getElementById('add_mr_btn_file');
                          
                          testbtn_addnewmodel.disabled = false;
                          testbtn_addnewmodel.style.backgroundColor = '#007bff';

                          add_mr_btn_file.disabled = false;
                          add_mr_btn_file.style.backgroundColor = '#007bff';
                        });

                        var gitlabButton = document.getElementById("gitlab-button");
                        gitlabButton.addEventListener("click", openGitLab);

                        function openGitLab() {
                          window.open("http://192.168.1.109:80", "_blank");
                        }

                        fileInput.addEventListener("change", () => {
                          gitUrlInput.classList.add("hidden");
                        });

                        gitUrlInput.addEventListener("input", () => {
                          fileInput.classList.add("hidden");
                          const url = gitUrlInput.value;
                          window.open(url, "_blank");
                        });

                        form.addEventListener("submit", (event) => {
                          event.preventDefault();
                          if (fileInput.files.length > 0) {
                            const file = fileInput.files[0];
                            // Upload file to local folder or remote Git repository using a fetch request or a library like Axios
                          } else if (gitUrlInput.value) {
                            const gitUrl = gitUrlInput.value;
                            // Upload files from remote Git repository using a fetch request or a library like Axios
                          }
                          form.reset();
                          form.classList.add("hidden");
                        });
                      </script>

                    </div>

                    <button class="mb-4 bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700">
                      Create new version
                    </button>

                  </div>

                  <div id="myModal" tabindex="-1" aria-hidden="true"
                    class="modal fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] md:h-full">
                    <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50"></div>

                    <div
                      class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto">

                      <div
                        class="modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 text-white text-sm z-50">
                        <svg class="fill-current text-white" xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                          viewBox="0 0 18 18">
                          <path d="M1 1l16 16m-16 0L1 17"></path>
                        </svg>
                        <span class="text-sm">(Esc)</span>
                      </div>

                      <div class="modal-content py-4 text-left px-6">
                        <h1 class="modal-header font-bold text-2xl mb-2">Modal Title</h1>
                        <p class="modal-text text-gray-700 mb-4">Modal content goes here.</p>

                        <div class="modal-buttons flex justify-end pt-2">
                          <button id="modalCloseButton"
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2">
                            Close
                          </button>
                          <button id="modalConfirmButton"
                            class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
                            Confirm
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>



                </div>


                <!-- Your table code goes here -->
                <div class="flex-1">

                  <table class="table-auto w-full h-full">
                    <tr>
                      <td class="border border-black px-4 py-2 text-center">
                        <button data-modal-target="testmodel" data-modal-toggle="testmodel"
                          class="bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700" id="testbtn_addnewmodel"
                          type="button">
                          Test Model
                        </button>
                      </td>
                      <!-- <td class="border border-black px-4 py-2 text-center"> <button
                          class="bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700"
                          type="submit" 
                          data-modal-target="modreg" 
                          data-modal-toggle="modreg"
                          >
                          Add to Model Registry
                        </button></td> -->

                      <td class="border border-black px-4 py-2 text-center"> <button
                          class="bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700"
                          type="submit" id='add_mr_btn_file'>
                          Add to Model Registry
                        </button></td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>


            <div id="createNewModel" class="tabcontent grid gap-6 m:grid-cols-2">
              <!-- <div id="createNewModel" class="tabcontent w-full overflow-hidden shadow-xs"> -->

              <div class="tab" style="font-size:10px">
                <button class="tablinksinner bg-purple-600 text-xs font-semibold"
                  onclick="openTabInner(event, 'writeNewCode')" id="defaultOpenInner">Write new code</button>
                <button class="tablinksinner bg-purple-600 text-xs font-semibold"
                  onclick="openTabInner(event, 'codePorting')">Code porting</button>
              </div>

              <div id="writeNewCode" class="tabcontentinner w-full overflow-hidden shadow-xs ">

                <!-- <div class="mt-8">
                    <select id="codeLanguage"
                      class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/3 p-2.5 dark:bg-gray-100 dark:border-gray-600 dark:placeholder-gray-400 dark:text-black dark:focus:ring-blue-500 dark:focus:border-blue-500">
                      <option selected>Choose your code language</option>
                      <option value="python">Python</option>
                      <option value="java">Java</option>
                      <option value="javascript">Javascript</option>
                    </select>
                  </div> -->

                <!-- CODE EDITOR API GOES HERE. -->

                <!-- <div>
                    <label class="block text-purple-600 dark:text-purple-300 font-bold mt-2" for="fileName">
                      File name (with extension)
                    </label>
                    <input
                      class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                      id="fileName" type="text" name="fileName" placeholder="" required>
                    </input>
              
                    <button type = 'submit' class="circular-btn mx-4 w-half bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700 mb-4" id="save-btn">
                      <i class="fa fa-floppy-o fa-lg">  Save file</i>
                    </button>
                  </div> -->


                <div
                  class="my-8 p-4 bg-gray-100 rounded-lg shadow-xs dark:bg-gray-100 dark:border-gray-600 dark:placeholder-gray-400 dark:text-black">


                  {% include 'codeEditor2.html' %}

                </div>
                <!-- <div class="grid m:grid-cols-3 w-full shadow-xs mx-6"> -->
                <div class="flex mx-4">
                  <!-- Form to write model details -->
                  <form class="bg-gray-100">
                    <div class="mb-4">
                      <label class="block text-gray-700 font-bold mb-2" for="modelname_code">
                        Name
                      </label>
                      <input
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                        id="modelname_code" type="text" placeholder="">
                      </input>
                    </div>

                    <div class="mb-4 mx-6">
                      <label class="block text-gray-700 font-bold mb-2" for="projectname_select_code">
                        Project Name
                      </label>
                      <select id="projectname_select_code"
                        class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/3 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                        <option value='default' selected>Select Project</option>
                        {% for pn in project_name %}
                        <option value="{{ pn.Project_Name }}">{{ pn.Project_Name }}</option>
                        {% endfor %}
                      </select>
                    </div>

                    <div class="mb-4">
                      <label class="block text-gray-700 font-bold mb-2" for="modelversion_code">
                        Version
                      </label>
                      <input
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                        id="modelversion_code" type="text" placeholder="">
                      </input>
                    </div>

                    <div class="mb-4">
                      <label class="block text-gray-700 font-bold mb-2" for="modeldescription_code">
                        Description
                      </label>
                      <input
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                        id="modeldescription_code" type="text" placeholder="">
                      </input>
                    </div>

                  </form>

                  <!-- Your table code goes here -->
                  <div class="flex-1">

                    <table class="table-auto w-full h-full">
                      <tr>
                        <td class="border border-black px-4 py-2 text-center"> <button
                            class="bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700"
                            type="submit" data-modal-target="testmodel" data-modal-toggle="testmodel" id="testbtn_createnewmodel">
                            Test Model
                          </button>
                        </td>
                        <td class="border border-black px-4 py-2 text-center"> <button
                            class="bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700"
                            type="submit" id='add_mr_btn_code'>
                            Add to Model Registry
                          </button></td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>

              <div id="codePorting" class="tabcontentinner w-full overflow-hidden shadow-xs">

                <!-- <div class="mt-8 flex gap-6">
                    <select id="portFromLanguage"
                      class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/3 p-2.5 dark:bg-gray-100 dark:border-gray-600 dark:placeholder-gray-400 dark:text-black dark:focus:ring-blue-500 dark:focus:border-blue-500">
                      <option selected>Port from...</option>
                      <option value="python">Python</option>
                      <option value="java">Java</option>
                      <option value="javascript">Javascript</option>
                    </select>

                    <select id="portToLanguage"
                      class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/3 p-2.5 dark:bg-gray-100 dark:border-gray-600 dark:placeholder-gray-400 dark:text-black dark:focus:ring-blue-500 dark:focus:border-blue-500">
                      <option selected>Port to...</option>
                      <option value="python">Python</option>
                      <option value="java">Java</option>
                      <option value="javascript">Javascript</option>
                    </select>

                    <button class="bg-white border border-gray-300 text-gray-900 text-sm font-bold rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/3 p-2.5 dark:bg-gray-100 dark:border-gray-600 dark:placeholder-gray-400 dark:text-black dark:focus:ring-blue-500 dark:focus:border-blue-500" onclick="validateCodePorting()"> Configure settings</button>
                  </div>  -->


                <!-- <div class="mt-2 flex gap-6">
                    <button class="bg-blue-500 text-white font-bold py-2 px-4 rounded mt-4 hover:bg-blue-700"
                      type="submit">
                      +Upload code
                    </button>
                  </div> -->

                <!-- <div class="flex flex-row flex-nowrap items-center gap-5 justify-center py-12"> -->
                <div class="flex flex-nowrap items-center gap-5 justify-top py-12">
                  <div class="just-a-border h-full p-6 text-left flex-1 bg-gray-100 mr-6">
                    <div class="mb-2 text-lg font-medium font-bold uppercase text-left">Code to translate</div>

                    <form method="post" id="translateForm">
                      <p class="font-semibold">Currently supported conversions: (1) Python <-> Javascript (2) Python <->
                            C++ (3) Python <-> C (4) Javascript <-> C++ </p>

                      {% csrf_token %}

                      <label for="portFromLanguage">Translate from:</label>
                      <select name="portFromLanguage" id="portFromLanguage">
                        <option value="python">Python</option>
                        <option value="javascript">Javascript</option>
                        <option value="c">C</option>
                        <option value="cpp">C++</option>
                        <!-- <option value="r">R</option> -->
                        <!-- Add options for other languages as needed -->
                      </select><br>

                      <label for="portToLanguage" class="mb-4">Translate to:</label>
                      <select name="portToLanguage" id="portToLanguage">
                        <option value="python">Python</option>
                        <option value="javascript">Javascript</option>
                        <option value="c">C</option>
                        <option value="cpp">C++</option>
                        <!-- <option value="r">R</option> -->
                        <!-- Add options for other languages as needed -->
                      </select><br>

                      <textarea name="codeTranslateFrom" rows="10" cols="80"></textarea><br>

                      <button type="submit" id="translateButton"
                        class="p-1 w-1/2 text-s font-semibold border border-gray-300">Translate</button>
                      <!-- <pre id="translatedCode"></pre> -->

                    </form>


                  </div>
                  <div class="just-a-border v-full p-6 text-left flex-nowrap flex-1 bg-gray-100">
                    <div class="mb-2 text-lg font-medium font-bold uppercase text-left flex-wrap">Translated code</div>
                    <pre id="translatedCode"></pre>

                  </div>
                </div>


              </div>
            </div>

          </div>
        </div>

    </div>
  </div>

  <div>
    <!-- CHART - to adapt from Accuracy page. -->


  </div>


  <div>
    <!-- popup forms -->


    <!-- popup form to select data to test the models -->
    <div id="testmodel" tabindex="-1" aria-hidden="true"
      class="modal fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] md:h-full">
      <div class="relative" style='width: 50%; height: 50%;'>
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700" style="height: 100%;">
          <form id='testmodel_submit'>
            {% csrf_token %}
            <div id='m1header' style='color: white; padding: 10px;'>
              <p>Data Catalog</p>
            </div>
            <div>
              <form id="dataset-form" method="GET">
                <div style='float: left; width: 50%;'>
                  <select id="dataset-select"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/3 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                    <option value='default' selected>Choose Dataset</option>
                    {% for ds in dataset_list %}
                    <option value="{{ ds.Dataset_ID }}">{{ ds.Dataset_name }}</option>
                    {% endfor %}
                  </select>

                </div>

                <div style='float: left; width: 50%;'>
                  <div style='margin: 10px; color: white;'>
                    <div id='dataset_info'>

                      <h2 style='font-size: 20px; align-content: middle; text-align: center; padding: 5px'>Selected
                        dataset information</h2>
                      <p style='padding: 5px'>Name: <span id="dataset-name"></span></p>
                      <p style='padding: 5px'>Number of rows: <span id="num-rows"></span></p>
                      <p style='padding: 5px'>Number of features: <span id="num-features"></span></p>
                      <p style='padding: 5px'>Target Variable: <span id="target-variable"></span></p>
                    </div>
                  </div>
                </div>
              </form>
            </div>


            <div id='m1footer' style='right:0; bottom: 0; position: absolute; padding: 10px;'>

              <button type="button" id='testdata_submit_btn' data-modal-hide="testmodel" data-dismiss="modal" style="padding: 2px 10px 2px 10px; margin: 20px;"
                class="btn btn-primary text-sm font-medium leading-5 text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-lg active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple">
                Choose this Dataset</button>

              <button id='close-testmodel' data-modal-hide="testmodel" data-dismiss="modal"
                style="padding: 2px 10px 2px 10px" type="button"
                class="btn btn-primary text-sm font-medium leading-5 text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-lg active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple">
                cancel</button>

            </div>

          </form>
        </div>
      </div>
    </div>



    <!-- popup form to show console log -->
    <div id="consolelog" tabindex="-1" aria-hidden="true"
      class="modal fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] md:h-full">
      <div class="relative" style='width: 50%; height: 50%;'>
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700" style="height: 100%;">


          <p class="modal-title" id="consolelog-title" style="color: white; margin: 20px; padding-top: 10px;">Console
            Log
          </p>

          <div class="modal-body" style='height: 70%; padding: 20px;'>

            <!-- {% csrf_token %} -->

            <div id="consolelog-output"></div>

            <div style='right:0; bottom: 0; position: absolute; padding: 20px;'>
              <button id='close-consolelog' data-dismiss="modal" style="padding: 2px 10px 2px 10px"
                data-modal-hide="consolelog" type="button"
                class="btn btn-primary text-sm font-medium leading-5 text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-lg active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple">
                cancel</button>
            </div>


          </div>

        </div>
      </div>
    </div>



    <!-- popup form to add model to registry   -->
    <div id="modreg" tabindex="-1" aria-hidden="true"
      class="modal fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] md:h-full">
      <div class="relative" style='width: 50%; height: 50%;'>
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700" style="height: 100%;">
          <form id='modreg_submit' style='height: 100%;'>
            {% csrf_token %}
            <div id='m1header' style='color: white; padding: 10px;'>
              <p>Data Catalog</p>
            </div>
            <div style='margin: 40px; background-color: white; height: 50%; padding: 50px;'>
              <ul id="myUL">
                <li>
                  <a href="#" style="display: inline">Model Name: </a>
                </li>
                <li>
                  <a href="#" style="display: inline">Replace with: </a>
                </li>
                <li>
                  <a href="#" style="display: inline">Reason for Change: </a>
                  <div class="dropdown-mr">
                    <select id="select_reason" aria-placeholder="Select Reason"
                      class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/3 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                      <option value="Accuracy" selected>Bug fixes</option>
                      <option value="Accuracy">Accuracy</option>
                      <option value="Outdated">Outdated</option>
                    </select>
                  </div>
                </li>
              </ul>
            </div>


            <div id='m1footer' style='right:0; bottom: 0; position: absolute; padding: 10px;'>

              <button type="submit" id='add_registry_btn' style="padding: 2px 10px 2px 10px; margin: 20px;"
                class="btn btn-primary text-sm font-medium leading-5 text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-lg active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple">
                Accept and Replace</button>

              <button id='close-modreg' data-modal-hide="modreg" data-dismiss="modal" style="padding: 2px 10px 2px 10px"
                type="button"
                class="btn btn-primary text-sm font-medium leading-5 text-white transition-colors duration-150 bg-purple-600 border border-transparent rounded-lg active:bg-purple-600 hover:bg-purple-700 focus:outline-none focus:shadow-outline-purple">
                cancel</button>

            </div>

          </form>
        </div>
      </div>
    </div>





  </div>

  </div>
  </div>




  <!-- Javascript for tabs -->
  <script>

    // import { Client } from 'pg';

    // Outer tab: 
    function openTab(evt, tabName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";

      // Get the element with id="defaultOpen" and click on it
      document.getElementById("defaultOpenInner").click();
    }

    // Get the element with id="defaultOpen" and click on it
    document.getElementById("defaultOpen").click();

    // Inner tab: 
    function openTabInner(evt, tabName) {
      var i, tabcontentinner, tablinks;
      tabcontentinner = document.getElementsByClassName("tabcontentinner");
      for (i = 0; i < tabcontentinner.length; i++) {
        tabcontentinner[i].style.display = "none";
      }
      tablinksinner = document.getElementsByClassName("tablinksinner");
      for (i = 0; i < tablinksinner.length; i++) {
        tablinksinner[i].className = tablinksinner[i].className.replace(" active", "");
      }
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";
    }

    // Validate the code porting options that user has selected
    function validateCodePorting() {

      var portFromLanguage = document.getElementById('portFromLanguage').value;
      var portToLanguage = document.getElementById('portToLanguage').value;
      const formData = new FormData(translateForm);

      if (portFromLanguage == "Port from..." || portToLanguage == "Port to...") {
        alert("Please select port language.");
      }
      else if (portFromLanguage === portToLanguage) {
        alert("Language to port from should be different from language to port to.")
      } else if (!(
        (portFromLanguage === "python" && portToLanguage === "cpp") ||
        (portFromLanguage === "python" && portToLanguage === "c") ||
        (portFromLanguage === "python" && portToLanguage === "javascript") ||
        (portFromLanguage === "javascript" && portToLanguage === "cpp") ||
        (portFromLanguage === "javascript" && portToLanguage === "python") ||
        (portFromLanguage === "cpp" && portToLanguage === "python") ||
        (portFromLanguage === "cpp" && portToLanguage === "javascript") ||
        (portFromLanguage === "c" && portToLanguage === "python")
      )) {
        alert("Currently supported conversions: (1) Python <-> Javascript (2) Python <-> C++ (3) Python <-> C (4) Javascript <-> C++");
      } else {
        return;
      }
    }

    // CODE PORTING 
    // Intercept form submission and send via AJAX 
    const translateForm = document.getElementById('translateForm');
    const translateButton = document.getElementById('translateButton');
    const translatedCode = document.getElementById('translatedCode');

    translateForm.addEventListener('submit', event => {

      validateCodePorting();

      console.log('in eventlistener')
      event.preventDefault();
      const formData = new FormData(translateForm);
      fetch('/app/challengers/modelRegistry/translate/', {
        method: 'POST',
        body: formData,
      }).then(response => response.json())
        .then(data => {
          console.log('translated_code');
          console.log(data.translated_code);
          translatedCode.textContent = data.translated_code;
        })
        .catch(error => console.error(error));
    });

    // translateForm.addEventListener('submit', event => {
    //   event.preventDefault();
    //   const formData = new FormData(translateForm);
    //   fetch('', {
    //     method: 'POST',
    //     body: formData,
    //   }).then(response => response.json())
    //     .then(data => {
    //       translatedCode.textContent = data.translated_code;
    //     });
    // });


    // // listener for alerting messages.
    // translateForm.addEventListener('messageAlert', event => {
    //   console.log(document.getElementById('message'))
    //   console.log(message)
    //   alert(document.getElementById('message'));
    // });


    // set the dropdown box to default whenever the user clicks on close button
    var selectdata_dropdown = document.getElementById("dataset-select");
    var defaultValue = selectdata_dropdown.querySelector("option[selected]").innerHTML;

    var selectdata_close = document.getElementById("close-testmodel");
    selectdata_close.addEventListener("click", function () {
      selectdata_dropdown.value = 'default';
      datasetName.textContent = '';
      numRows.textContent = '';
      numFeatures.textContent = '';

    });

    // function getDatasetDetails() {
    //   var select_option = selectdata_dropdown.options[selectdata_dropdown.selectedIndex].value;
    //   const client = new Client({
    //     user: 'postgres',
    //     host: 'localhost',
    //     database: 'BT4301',
    //     password: 1234,
    //     port: 5432,
    //   });

    //   client.connect();

    //   client.query('SELECT * FROM core_dataset_list WHERE Dataset_id = $1 LIMIT 1', [option], (err, res) => {
    //     if (err) throw err;
    //     var data = res.rows[0];
    //     var ds_name = document.getElementById("dataset_name");
    //     var ds_nrows = document.getElementById("dataset_nrows");
    //     var ds_nfeatures = document.getElementById("dataset_nfeatures");
    //     ds_name.textContent = data.Dataset_name
    //     ds_nrows.textContent = data.num_of_rows
    //     ds_nfeatures.textContent = data.num_of_features

    //     client.end();
    //   });
    // }




    // Add an event listener to the drop-down box
    const datasetSelect = document.getElementById('dataset-select');
    const datasetName = document.getElementById('dataset-name');
    const numRows = document.getElementById('num-rows');
    const numFeatures = document.getElementById('num-features');
    const targetVariable = document.getElementById('target-variable');


    datasetSelect.addEventListener('change', () => {
      const datasetId = datasetSelect.value;
      const xhr = new XMLHttpRequest();
      // xhr.open('GET', `/challengers/modelRegistry/?dataset_id=${datasetId}`);
      if (datasetId === 'default') {
        datasetName.textContent = '';
        numRows.textContent = '';
        numFeatures.textContent = '';
        targetVariable.textContent = '';
      } else {
        xhr.open('GET', `{% url "modelRegistry" %}?dataset_id=${datasetId}`);
        xhr.setRequestHeader('Accept', 'application/json'); // add this line
        xhr.onload = () => {
          const dataset = JSON.parse(xhr.responseText);
          datasetName.textContent = dataset.Dataset_name;
          numRows.textContent = dataset.num_of_rows;
          numFeatures.textContent = dataset.num_of_features;
          targetVariable.textContent = dataset.Target;
        };
        xhr.send();
      }

    });

    var language_from_code;


    // check if code file has been uploaded. if not uploaded, testbtn_addnewmodel is disabled. same for add_mr_btn_file
    var testbtn_addnewmodel = document.getElementById('testbtn_addnewmodel');
    testbtn_addnewmodel.disabled = true;
    testbtn_addnewmodel.style.backgroundColor = 'grey';

    var add_mr_btn_file = document.getElementById('add_mr_btn_file');
    add_mr_btn_file.disabled = true;
    add_mr_btn_file.style.backgroundColor = 'grey';

  //   $(document).ready(function () {
  //     window.addEventListener('message', event => {
  //       var testbtn_addnewmodel = document.getElementById('testbtn_addnewmodel');
  //       var add_mr_btn_file = document.getElementById('add_mr_btn_file');

  //       if (event.origin !== window.location.origin) return;
  //       const result = event.data;

  //       if (result === 'failed') {
  //         console.log('Code failed to run');
  //         testbtn_createnewmodel.disabled = true;
  //         testbtn_createnewmodel.style.backgroundColor = 'grey';
  //         // testbtn_createnewmodel.tooltip = 'Please fix the code before testing';

  //         add_mr_btn_code.disabled = true;
  //         add_mr_btn_code.style.backgroundColor = 'grey';

  //       } else {
  //         console.log('Code ran successfully');
  //         testbtn_createnewmodel.disabled = false;
  //         testbtn_createnewmodel.style.backgroundColor = '#007bff';
  //         // testbtn_createnewmodel.tooltip = '';

  //         add_mr_btn_code.disabled = false;
  //         add_mr_btn_code.style.backgroundColor = '#007bff';
          
  //       }

  //       });
  // });


    // check if the code is successful. if not successful, testbtn_createnewmodel is disabled. same for add_mr_btn_code
    var testbtn_createnewmodel = document.getElementById('testbtn_createnewmodel');
    testbtn_createnewmodel.disabled = true;
    testbtn_createnewmodel.style.backgroundColor = 'grey';
    // testbtn_createnewmodel.tooltip = 'Please run code before testing';

    var add_mr_btn_code = document.getElementById('add_mr_btn_code');
    add_mr_btn_code.disabled = true;
    add_mr_btn_code.style.backgroundColor = 'grey';
    
    $(document).ready(function () {
      window.addEventListener('message', event => {
        var testbtn_createnewmodel = document.getElementById('testbtn_createnewmodel');
        var add_mr_btn_code = document.getElementById('add_mr_btn_code');

        if (event.origin !== window.location.origin) return;
        const child_data = event.data;
        const result = child_data.result;
        language_from_code = child_data.lang;
        console.log('this is the result in mod reg:  ', child_data);

        if (result === 'failed') {
          console.log('Code failed to run');
          testbtn_createnewmodel.disabled = true;
          testbtn_createnewmodel.style.backgroundColor = 'grey';
          // testbtn_createnewmodel.tooltip = 'Please fix the code before testing';

          add_mr_btn_code.disabled = true;
          add_mr_btn_code.style.backgroundColor = 'grey';

        } else {
          console.log('Code ran successfully');
          testbtn_createnewmodel.disabled = false;
          testbtn_createnewmodel.style.backgroundColor = '#007bff';
          // testbtn_createnewmodel.tooltip = '';

          add_mr_btn_code.disabled = false;
          add_mr_btn_code.style.backgroundColor = '#007bff';
          
        }
      });
    });


    // when click on choose this dataset button. run the code and show the accuracy rate. 
    var testdata_submit_btn = $('#testdata_submit_btn');
    testdata_submit_btn.click(function () {
      console.log('clicked on submit')
      var dataset_rows = parseInt(document.getElementById('num-rows').textContent);
      if (dataset_rows >= 800) {
        window.alert('Huge dataset detected. Spinning up RAM for better efficiency')
      }
      // check with the team on whether we should show accuracy? get random data? or how does it work?
    });


    // Add to Model Registry Button
    // for files
    var add_mr_btn_file = $('#add_mr_btn_file');
    add_mr_btn_file.click(function (event) {
      event.preventDefault();
      const modelname_file = document.getElementById('modelname_file').value;
      const modellanguage_file = document.getElementById('modellanguage_file').value;
      const version_file = document.getElementById('modelversion_file').value;
      const description_file = document.getElementById('modeldescription_file').value;
      const project_name_file = document.getElementById('projectname_select_file').value;
      const datasetId_file = datasetSelect.value;


      if (modelname_file === '' || modellanguage_file === '' || version_file === '' || description_file === '' || project_name_file === 'default' || datasetId_file === 'default') {
        window.alert('Please fill up all information before adding to model registry')
        return;
      }
      else {

        console.log('in the ajax')
        console.log(datasetId_file)
        const csrf_token = $('input[name="csrfmiddlewaretoken"]').val();
        $.ajax({
          url: './modelRegistry/add-model/',
          type: 'POST',
          beforeSend: function (xhr, settings) {
            xhr.setRequestHeader("X-CSRFToken", csrf_token);
          },
          // contentType: 'application/json',
          // data: JSON.stringify({ model_id: model_id, status: model_status }),
          contentType: 'application/x-www-form-urlencoded',
          data: {
            'model_name': modelname_file,
            'language': modellanguage_file,
            'version': version_file,
            'description': description_file,
            'project_name': project_name_file,
            'datasetId': datasetId_file,
            'csrfmiddlewaretoken': csrf_token
          },
          success: function (response) {
            console.log('this is the response')
            console.log(response);

            // location.reload(); // important! change to load challengers page instead
          },
          error: function (xhr, status, error) {
            console.error('Error:', xhr.status, status, error);
          }
        });
      }
    });


    // Add to Model Registry Button
    // for new Code
    var add_mr_btn_code = $('#add_mr_btn_code');
    add_mr_btn_code.click(function (event) {

      event.preventDefault();
      const modelname_code = document.getElementById('modelname_code').value;
      const modellanguage_code = language_from_code;
      const version_code = document.getElementById('modelversion_code').value;
      const description_code = document.getElementById('modeldescription_code').value;
      const project_name_code = document.getElementById('projectname_select_code').value;
      const datasetId_code = datasetSelect.value;

      console.log('this is my model language: ', modellanguage_code)

      if (modelname_code === '' || modellanguage_code === '' || version_code === '' || description_code === '' || project_name_code === 'default' || datasetId_code === 'default') {
        window.alert('Please fill up all information before adding to model registry')
        return;
      }
      else {

        console.log('still run leh')
        const csrf_token = $('input[name="csrfmiddlewaretoken"]').val();
        $.ajax({
          url: './modelRegistry/add-model/',
          type: 'POST',
          beforeSend: function (xhr, settings) {
            xhr.setRequestHeader("X-CSRFToken", csrf_token);
          },
          // contentType: 'application/json',
          // data: JSON.stringify({ model_id: model_id, status: model_status }),
          contentType: 'application/x-www-form-urlencoded',
          data: {
            'model_name': modelname_code,
            'language': modellanguage_code,
            'version': version_code,
            'description': description_code,
            'project_name': project_name_code,
            'datasetId': datasetId_code,
            'csrfmiddlewaretoken': csrf_token
          },
          success: function (response) {
            console.log(response);
            // location.reload(); // important! change to load challengers page instead
          },
          error: function (xhr, status, error) {
            console.error('Error:', xhr.status, status, error);
          }
        });
      }

    });

  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.4/flowbite.min.js"></script>

  <script src="/static/js/popup.js"></script>




</body>

</html>